<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Getting the software &#8212; HiPERCAM pipeline 0.1.dev1+g751ab3c49 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/bootstrap-astropy.css?v=177ce38d" />
    
    <script src="_static/documentation_options.js?v=183a7e36"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Useful files" href="files.html" />
    <link rel="prev" title="Data logging" href="api/logging.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">astro</span><span id="logotext2"></span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="files.html" title="Useful files">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="api/logging.html" title="Data logging">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">HiPERCAM pipeline 0.1.dev1+g751ab3c49 documentation</a>
	 &#187;
      </li>
      
      <li>Getting the software</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="getting-the-software">
<h1>Getting the software<a class="headerlink" href="#getting-the-software" title="Link to this heading">¶</a></h1>
<section id="hiper-readme-file">
<h2>HiPERCAM README file<a class="headerlink" href="#hiper-readme-file" title="Link to this heading">¶</a></h2>
<p>Here is the HiPERCAM README file which is written in the same markup language
as the rest of these pages.</p>
</section>
<section id="hipercam">
<h2>hipercam<a class="headerlink" href="#hipercam" title="Link to this heading">¶</a></h2>
<p>hipercam is the reduction package for the multi-CCD camera HiPERCAM
built through an ERC Advanced Grant awarded to Vik Dhillon. HiPERCAM
is a multi-CCD high-speed camera for astrophysical research. The
hipercam pipeline can also be used to reduce data from the ULTRACAM
and ULTRASPEC high-speed cameras, and other instruments too.</p>
<p>More information about using the hipercam package can be found in
<a class="reference external" href="https://vikdhillon.staff.shef.ac.uk/hipercam/pipeline/index.html">the documentation</a>.</p>
</section>
<section id="docker-installation">
<h2>Docker Installation<a class="headerlink" href="#docker-installation" title="Link to this heading">¶</a></h2>
<p>The easiest way to install hipercam is to create a Docker image. This
is simple and cross-platform, but the image is large (around 2.8GB). To
install via this route, please download the
<a class="reference external" href="https://raw.githubusercontent.com/HiPERCAM/hipercam/refs/heads/master/data/hipercam.dockerfile">dockerfile</a></p>
<section id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Link to this heading">¶</a></h3>
<p>To build the docker image from the docker file, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">hipercam</span><span class="p">:</span><span class="n">latest</span> <span class="o">-</span><span class="n">f</span> <span class="n">hipercam</span><span class="o">.</span><span class="n">dockerfile</span> <span class="o">.</span>
</pre></div>
</div>
<p>And, to run the image, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">some</span><span class="o">-</span><span class="n">data</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hiperuser</span><span class="o">/</span><span class="n">data</span> <span class="n">hipercam</span><span class="p">:</span><span class="n">latest</span>
</pre></div>
</div>
<p>This will mount <cite>&lt;local-path-to-some-data&gt;</cite> in the virtual machine at
<cite>/home/hiperuser/data</cite>. You can then run the pipeline as normal.</p>
</section>
<section id="macos">
<h3>MacOS<a class="headerlink" href="#macos" title="Link to this heading">¶</a></h3>
<p>Installation on Apple Silicon Macs is a little more complicated. The instructions below assume you have a modern
MacOS/Apple Silicon system with Docker Desktop installed.</p>
<p>To build the docker image from the docker file, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">build</span> <span class="o">-</span><span class="n">t</span> <span class="n">hipercam</span><span class="p">:</span><span class="n">latest</span> <span class="o">--</span><span class="n">platform</span> <span class="n">linux</span><span class="o">/</span><span class="n">amd64</span> <span class="o">-</span><span class="n">f</span> <span class="n">hipercam</span><span class="o">.</span><span class="n">dockerfile</span> <span class="o">.</span>
</pre></div>
</div>
<p>And, to run the image, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xhost</span> <span class="o">+</span>
<span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">it</span> <span class="o">-</span><span class="n">e</span> <span class="n">DISPLAY</span><span class="o">=</span><span class="n">host</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">internal</span><span class="p">:</span><span class="mi">0</span> <span class="o">--</span><span class="n">platform</span> <span class="n">linux</span><span class="o">/</span><span class="n">amd64</span> <span class="o">--</span><span class="n">rm</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;</span><span class="n">local</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">some</span><span class="o">-</span><span class="n">data</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">hiperuser</span><span class="o">/</span><span class="n">data</span> <span class="n">hipercam</span><span class="p">:</span><span class="n">latest</span>
</pre></div>
</div>
<p>This will mount <cite>&lt;local-path-to-some-data&gt;</cite> in the virtual machine at
<cite>/home/hiperuser/data</cite>. You can then run the pipeline as normal.</p>
</section>
</section>
<section id="manual-installation">
<h2>Manual Installation<a class="headerlink" href="#manual-installation" title="Link to this heading">¶</a></h2>
<p>hipercam is written in Python3; it does not support Python2.x It
relies on multiple third-party packages, as described in the next
section.  At minimum, you should ensure that Cython and trm.pgplot are
installed.  Once you have, get the hipercam pipeline software itself
using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">HiPERCAM</span><span class="o">/</span><span class="n">hipercam</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>This will create a directory; if you are updating then a simple “git
pull” from within this directory should suffice. Change to this
directory and install with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">.</span> <span class="o">--</span><span class="n">user</span>
</pre></div>
</div>
<p>If you have multiple versions of python, then you might need to
specify pip3. If you want a self-contained install, I suggest looking
into using “pipenv”.</p>
<p>I use the Qt5Agg backend to ensure that the important command
<code class="xref py py-func docutils literal notranslate"><span class="pre">setaper</span></code> works. Others may work too of course. I have this set as the
default in my .config/matplotlib/matplotlibrc configuartion file with
the line <cite>backend: Qt5Agg</cite></p>
</section>
<section id="building-from-source">
<h2>Building from Source<a class="headerlink" href="#building-from-source" title="Link to this heading">¶</a></h2>
<p>You can build the package from source using the standard Python build tools.</p>
<p>Make sure you have the required build tools installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">build</span>
</pre></div>
</div>
<p>To build a source distribution (tarball):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">build</span> <span class="o">--</span><span class="n">sdist</span>
</pre></div>
</div>
<p>To build a wheel (binary distribution):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">build</span> <span class="o">--</span><span class="n">wheel</span>
</pre></div>
</div>
<p>To build both source and wheel distributions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">build</span>
</pre></div>
</div>
<p>For development, you can install the package in editable mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
<p>This will install the package in development mode, so changes to the
source code are immediately reflected without needing to reinstall.</p>
<p>Note: The package includes Cython extensions that need to be compiled,
so you’ll need a C compiler and the build dependencies (Cython, numpy)
available during the build process.</p>
</section>
<section id="third-party-modules">
<h2>Third-Party Modules<a class="headerlink" href="#third-party-modules" title="Link to this heading">¶</a></h2>
<p>Apart from Cython and trm.pgplot, I hope that most of the extras will
get automatically installed if necessary by pip. So, if you have
Cython and PGPLOT ready, you might as well try <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span>
<span class="pre">.</span> <span class="pre">--user</span></code> here and now.</p>
<p>If something seems amiss, here are details of the third-party packages
which you can either install via pip or by looking for the packages in
your O/S package manager. e.g. under fedora, Cython appears as
<code class="docutils literal notranslate"><span class="pre">python3-Cython</span></code>.</p>
<blockquote>
<div><dl>
<dt>astropy :</dt><dd><p>astronomical Python package with lots of useful stuff.</p>
</dd>
<dt>Cython :</dt><dd><p>C-extensions for Python. Widely used package used to interface
to C-libraries and to enable faster code when critical. It is
needed at the setup stage so it might have to be installed first
rather than relying on pip finding it, although I could be wrong.</p>
</dd>
<dt>fitsio :</dt><dd><p>Provides fairly direct access to FITS through the cfitsio library.
Has some features that the pure python implementation in astropy
lacks.</p>
</dd>
<dt>keyring:</dt><dd><p>Used in ‘logsearch’ to store some passwords safely.</p>
</dd>
<dt>matplotlib :</dt><dd><p>standard plotting package for Python. You will also need
a Qt backend. In opensuse for instance the package
python3-matplotib-qt5 enables the Qt5Agg backend.</p>
</dd>
<dt>numba :</dt><dd><p>Another package along with Cython to support faster numerics. Uses
“just-in-time” compilation of selected routines.</p>
</dd>
<dt>numpy :</dt><dd><p>Python’s numerical data package. Highly likely you will have
it.</p>
</dd>
<dt>pandas :</dt><dd><p>Widely used table-handling module, based on numpy, and again
quite likely installed already. It is used for some routines
to do with generation of spreadsheets and logs in the
pipeline (see also xlsxwriter below).</p>
</dd>
<dt>requests :</dt><dd><p>http request module. It may well be installed already.</p>
</dd>
<dt>scipy :</dt><dd><p>Scientific software for Python, closely linked to numpy.</p>
</dd>
<dt>sep :</dt><dd><p>astronomical source extractor based on Bertin’s source extractor.</p>
</dd>
<dt>reproject:</dt><dd><p>The reproject package implements image reprojection methods
for astronomical images. This is an optional dependency,
but you will need it for <cite>shiftadd</cite> to work.</p>
</dd>
<dt>setuptools_scm :</dt><dd><p>package to manage version numbers from the git repository</p>
</dd>
<dt>trm.pgplot :</dt><dd><p>Cython-ised wrapper for PGPLOT which I wrote specifically for
hipercam although it is entirely independent of it. PGPLOT is
needed for some of the faster plots as matplotlib is way too
slow (at least as standardly used; I am hoping to move
towards matplotlib-only). PGPLOT itself (F77/C library) must
be installed for this to work. Once you have PGPLOT, you can
get trm.pgplot from my github site with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">trmrsh</span><span class="o">/</span><span class="n">trm</span><span class="o">-</span><span class="n">pgplot</span>
</pre></div>
</div>
<p>trm.pgplot is not to be confused with “ppgplot” which,
although very similar, is a more hand-crafted version with
some differences in the calls. Once you have cloned it, you
can enter trm-pgplot and install with pip, but make sure to
set the enviroment variable PGPLOT_PNG inside setup.py to
“true” or “false” first, according to whether you installed
the PNG drivers with PGPLOT.</p>
</dd>
<dt>trm.cline :</dt><dd><p>handles command line parameters. Available on PyPi.</p>
</dd>
<dt>trm.utils :</dt><dd><p>generally useful routines used at a few places. Available
from PyPi.</p>
</dd>
<dt>websocket-client :</dt><dd><p>for talking to the hipercam server.</p>
</dd>
<dt>xlsxwriter :</dt><dd><p>if you want to use the logging scripts hlogger, the object
search script logsearch, or build log database tools that
output xlsx files. Since these are unusual, the software is
designed to build without insisting on this module.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Link to this heading">¶</a></h2>
<p>The hipercam pipeline is made for its users, and we welcome contributions of many kinds.
If you notice a bug, or want to request new functionality, please
<a class="reference external" href="https://github.com/HiPERCAM/hipercam/issues">raise an issue</a> or consider submitting
a <a class="reference external" href="https://github.com/HiPERCAM/hipercam/pulls">pull request</a>.</p>
</section>
<section id="further-information">
<h2>Further Information<a class="headerlink" href="#further-information" title="Link to this heading">¶</a></h2>
<p>For more information see:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://vikdhillon.staff.shef.ac.uk/hipercam/pipeline/index.html">The documentation</a></p></li>
<li><p><a class="reference external" href="https://github.com/HiPERCAM/hipercam">The HiPERCAM pipeline github repository</a></p></li>
</ul>
</div></blockquote>
<p>Tom Marsh</p>
</section>
<section id="updating">
<h2>Updating<a class="headerlink" href="#updating" title="Link to this heading">¶</a></h2>
<p>You should keep the directory ‘hipercam’ created by the first <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span></code>
command because then it makes updating simple. It becomes a matter of going
to the hipercam directory, pulling the changes from github, and
re-installing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">XXX</span><span class="o">/</span><span class="n">YYY</span><span class="o">/</span><span class="n">hipercam</span>
<span class="n">git</span> <span class="n">pull</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span>
</pre></div>
</div>
<p>(the last line may vary according to how you install it).</p>
</section>
<section id="setting-up">
<h2>Setting up<a class="headerlink" href="#setting-up" title="Link to this heading">¶</a></h2>
<p>In order to use the HiPERCAM pipeline for normal reduction, you just need the
commands in your path. Try typing <code class="docutils literal notranslate"><span class="pre">hplot</span></code> (a command) to see if they
are. Apart from this there are a few environment variables to know about.</p>
<p>If using the pipeline in conjunction with the HiPERCAM instrument, and you
wish to use your own laptop rather than the dat reduction PC, then you need to
tell it where the server is which you do by setting an environment variable
called HIPERCAM_DEFAULT_URL. Typically I do this in my .cshrc file (C-shell,
use export with bash) with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">setenv</span> <span class="n">HIPERCAM_DEFAULT_URL</span> <span class="mf">192.168.1.2</span><span class="p">:</span><span class="mi">8007</span><span class="o">/</span>
</pre></div>
</div>
<p>The value here is appropriate if you are connected to the HiPERCAM private
network via ethernet at the telescope. Note that there is no leading ‘<a class="reference external" href="http://">http://</a>’
unlike the equivalent in the ULTRACAM pipeline because this address is used
with both http and web sockets and the appropriate prefix is tacked on by
whichever script is being used.  Also note the final ‘/’ on the port number as
in ‘8007/’, which must be there. When setting up for the first time, assuming
that the HiPERCAM file server is going, then the command <code class="xref py py-func docutils literal notranslate"><span class="pre">hls</span></code> is a good one to start with to see that you are
set up correctly. Correspondingly, try <code class="xref py py-func docutils literal notranslate"><span class="pre">uls</span></code> if running the HiPERCAM pipeline
with the ULTRACAM server.</p>
<p>I have sometimes found matplotlib plots simply do not appear, e.g. the mean
level plot in <code class="xref py py-func docutils literal notranslate"><span class="pre">makebias</span></code>. If you encounter this problem, have a look at your
matplotlibrc file, probably located in .config/matplotlib in your home
directory. Mine say <code class="docutils literal notranslate"><span class="pre">backend</span> <span class="pre">:</span> <span class="pre">Qt4Agg</span></code> at the top, and you may need
something similar, depending on your matplotlib distribution.</p>
<p>Here is a summary table of all environment variables associated with
HiPERCAM and their purpose. If you are simply reducing data at your home
institute, you probably won’t need to set any of these.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Environment variable</p></th>
<th class="head"><p>Purpose</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>HIPERCAM_DEFAULT_SOURCE</p></td>
<td><p>Sets the default “source”. Primarily useful for the instrument
control computer.</p></td>
</tr>
<tr class="row-odd"><td><p>HIPERCAM_DEFAULT_URL</p></td>
<td><p>URL of the HiPERCAM FileServer on the rack PC to access data</p></td>
</tr>
<tr class="row-even"><td><p>HIPERCAM_ENV</p></td>
<td><p>Directory for storage of default parameter files
(~/.hipercam by default). Temporary files are stored in a
sub-drectory of this called “tmp”. Although attempts are made
to delete such files, it is worth checking every now an again
that it does not contain too much junk.</p></td>
</tr>
<tr class="row-odd"><td><p>ULTRACAM_DEFAULT_URL</p></td>
<td><p>URL of the ULTRACAM FileServer on the rack PC to access data</p></td>
</tr>
</tbody>
</table>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper"><h3>Table of Contents</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="news.html">HiPERCAM pipeline news</a></li>
<li class="toctree-l1"><a class="reference internal" href="observers.html">Observer’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="commands.html">HiPERCAM commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/api.html">The API</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting the software</a></li>
<li class="toctree-l1"><a class="reference internal" href="files.html">Useful files</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/bugs.html">Reporting problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="makingmovies.html">Making HiPERCAM movies</a></li>
<li class="toctree-l1"><a class="reference internal" href="phaseII.html">HiPERCAM Phase II</a></li>
</ul>


  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="api/logging.html"
                          title="previous chapter">Data logging</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="files.html"
                          title="next chapter">Useful files</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/installation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/installation.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2017, T.R. Marsh.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.4.7. &nbsp;
  </p>
</footer>
  </body>
</html>